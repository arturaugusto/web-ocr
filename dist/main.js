!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){var n;!function(a){"use strict";function i(e,t,r){var n,a=document.createElement("img");function o(t,o){o&&console.log(o),t&&i.isInstanceOf("Blob",t)?(e=t,n=i.createObjectURL(e)):(n=e,r&&r.crossOrigin&&(a.crossOrigin=r.crossOrigin)),a.src=n}return a.onerror=function(o){return i.onerror(a,o,e,n,t,r)},a.onload=function(o){return i.onload(a,o,e,n,t,r)},"string"==typeof e?(i.hasMetaOption(r)?i.fetchBlob(e,o,r):o(),a):i.isInstanceOf("Blob",e)||i.isInstanceOf("File",e)?(n=i.createObjectURL(e))?(a.src=n,a):i.readFile(e,(function(e){var r=e.target;r&&r.result?a.src=r.result:t&&t(e)})):void 0}var o=a.createObjectURL&&a||a.URL&&URL.revokeObjectURL&&URL||a.webkitURL&&webkitURL;function s(e,t){!e||"blob:"!==e.slice(0,5)||t&&t.noRevoke||i.revokeObjectURL(e)}i.hasMetaOption=function(e){return e&&e.meta},i.fetchBlob=function(e,t){t()},i.isInstanceOf=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},i.transform=function(e,t,r,n,a){r(e,a)},i.onerror=function(e,t,r,n,a,i){s(n,i),a&&a.call(e,t)},i.onload=function(e,t,r,n,a,o){s(n,o),a&&i.transform(e,o,a,r,{originalWidth:e.naturalWidth||e.width,originalHeight:e.naturalHeight||e.height})},i.createObjectURL=function(e){return!!o&&o.createObjectURL(e)},i.revokeObjectURL=function(e){return!!o&&o.revokeObjectURL(e)},i.readFile=function(e,t,r){if(a.FileReader){var n=new FileReader;if(n.onload=n.onerror=t,n[r=r||"readAsDataURL"])return n[r](e),n}return!1},void 0===(n=function(){return i}.call(t,r,t,e))||(e.exports=n)}("undefined"!=typeof window&&window||this)},function(e,t,r){var n,a,i;!function(o){"use strict";a=[r(0)],void 0===(i="function"==typeof(n=function(e){var t="undefined"!=typeof Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);e.blobSlice=t&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},e.metaDataParsers={jpeg:{65505:[],65517:[]}},e.parseMetaData=function(t,r,n,a){a=a||{};var i=this,o=(n=n||{}).maxMetaDataSize||262144;!!("undefined"!=typeof DataView&&t&&t.size>=12&&"image/jpeg"===t.type&&e.blobSlice)&&e.readFile(e.blobSlice.call(t,0,o),(function(t){if(t.target.error)return console.log(t.target.error),void r(a);var o,s,l,c,u=t.target.result,d=new DataView(u),h=2,f=d.byteLength-4,g=h;if(65496===d.getUint16(0)){for(;h<f&&((o=d.getUint16(h))>=65504&&o<=65519||65534===o);){if(h+(s=d.getUint16(h+2)+2)>d.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if((l=e.metaDataParsers.jpeg[o])&&!n.disableMetaDataParsers)for(c=0;c<l.length;c+=1)l[c].call(i,d,h,s,a,n);g=h+=s}!n.disableImageHead&&g>6&&(u.slice?a.imageHead=u.slice(0,g):a.imageHead=new Uint8Array(u).subarray(0,g))}else console.log("Invalid JPEG file: Missing JPEG marker.");r(a)}),"readAsArrayBuffer")||r(a)},e.replaceHead=function(t,r,n){e.parseMetaData(t,(function(a){n(new Blob([r,e.blobSlice.call(t,a.imageHead.byteLength)],{type:"image/jpeg"}))}),{maxMetaDataSize:256,disableMetaDataParsers:!0})};var r=e.transform;e.transform=function(t,n,a,i,o){e.hasMetaOption(n)?e.parseMetaData(i,(function(o){r.call(e,t,n,a,i,o)}),n,o):r.apply(e,arguments)}})?n.apply(t,a):n)||(e.exports=i)}()},function(e,t){e.exports=(e,t)=>`${e}-${t}-${Math.random().toString(16).slice(3,8)}`},function(e,t){let r=!1;t.logging=r,t.setLogging=e=>{r=e},t.log=(...e)=>r?console.log.apply(this,e):null},function(e,t){var r,n,a=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l,c=[],u=!1,d=-1;function h(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&f())}function f(){if(!u){var e=s(h);u=!0;for(var t=c.length;t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length}l=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function p(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new g(e,t)),1!==c.length||u||s(f)},g.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=p,a.addListener=p,a.once=p,a.off=p,a.removeListener=p,a.removeAllListeners=p,a.emit=p,a.prependListener=p,a.prependOnceListener=p,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t,r){var n,a;void 0===(a="function"==typeof(n=function(){return function(){var e=arguments.length;if(0===e)throw new Error("resolveUrl requires at least one argument; got none.");var t=document.createElement("base");if(t.href=arguments[0],1===e)return t.href;var r=document.getElementsByTagName("head")[0];r.insertBefore(t,r.firstChild);for(var n,a=document.createElement("a"),i=1;i<e;i++)a.href=arguments[i],n=a.href,t.href=n;return r.removeChild(t),n}})?n.call(t,r,t,e):n)||(e.exports=a)},function(e,t,r){const n=r(2);let a=0;e.exports=({id:e,action:t,payload:r={}})=>{let i=e;return void 0===i&&(i=n("Job",a),a+=1),{id:i,action:t,payload:r}}},function(e,t,r){const n=r(17),a=r(20),i=r(6),{log:o}=r(3),s=r(2),{defaultOEM:l}=r(21),{defaultOptions:c,spawnWorker:u,terminateWorker:d,onMessage:h,loadImage:f,send:g}=r(22);let p=0;e.exports=(e={})=>{const t=s("Worker",p),{logger:r,errorHandler:m,...v}=n({...c,...e}),y={},b={};let w=u(v);p+=1;const A=(e,t)=>{y[e]=t},x=(e,t)=>{b[e]=t},S=({id:e,action:r,payload:n})=>new Promise((a,i)=>{o(`[${t}]: Start ${e}, action=${r}`),A(r,a),x(r,i),g(w,{workerId:t,jobId:e,action:r,payload:n})});return h(w,({workerId:e,jobId:t,status:n,action:i,data:s})=>{if("resolve"===n){o(`[${e}]: Complete ${t}`);let r=s;"recognize"===i?r=a(s):"getPDF"===i&&(r=Array.from({...s,length:Object.keys(s).length})),y[i]({jobId:t,data:r})}else if("reject"===n){if(b[i](s),!m)throw Error(s);m(s)}else"progress"===n&&r(s)}),{id:t,worker:w,setResolve:A,setReject:x,load:e=>S(i({id:e,action:"load",payload:{options:v}})),writeText:(e,t,r)=>S(i({id:r,action:"FS",payload:{method:"writeFile",args:[e,t]}})),readText:(e,t)=>S(i({id:t,action:"FS",payload:{method:"readFile",args:[e,{encoding:"utf8"}]}})),removeFile:(e,t)=>S(i({id:t,action:"FS",payload:{method:"unlink",args:[e]}})),FS:(e,t,r)=>S(i({id:r,action:"FS",payload:{method:e,args:t}})),loadLanguage:(e="eng",t)=>S(i({id:t,action:"loadLanguage",payload:{langs:e,options:v}})),initialize:(e="eng",t=l,r)=>S(i({id:r,action:"initialize",payload:{langs:e,oem:t}})),setParameters:(e={},t)=>S(i({id:t,action:"setParameters",payload:{params:e}})),recognize:async(e,t={},r)=>S(i({id:r,action:"recognize",payload:{image:await f(e),options:t}})),getPDF:(e="Tesseract OCR Result",t=!1,r)=>S(i({id:r,action:"getPDF",payload:{title:e,textonly:t}})),detect:async(e,t)=>S(i({id:t,action:"detect",payload:{image:await f(e)}})),terminate:async()=>(null!==w&&(d(w),w=null),Promise.resolve())}}},function(e,t){e.exports={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}},function(e,t,r){var n,a,i;!function(o){"use strict";a=[r(0)],void 0===(i="function"==typeof(n=function(e){var t=e.transform;e.transform=function(r,n,a,i,o){t.call(e,e.scale(r,n,o),n,a,i,o)},e.transformCoordinates=function(){},e.getTransformedOptions=function(e,t){var r,n,a,i,o=t.aspectRatio;if(!o)return t;for(n in r={},t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.crop=!0,(a=e.naturalWidth||e.width)/(i=e.naturalHeight||e.height)>o?(r.maxWidth=i*o,r.maxHeight=i):(r.maxWidth=a,r.maxHeight=a/o),r},e.renderImageToCanvas=function(e,t,r,n,a,i,o,s,l,c,u){var d=e.getContext("2d");return!1===u.imageSmoothingEnabled?d.imageSmoothingEnabled=!1:u.imageSmoothingQuality&&(d.imageSmoothingQuality=u.imageSmoothingQuality),d.drawImage(t,r,n,a,i,o,s,l,c),e},e.hasCanvasOption=function(e){return e.canvas||e.crop||!!e.aspectRatio},e.scale=function(t,r,n){r=r||{};var a,i,o,s,l,c,u,d,h,f,g,p=document.createElement("canvas"),m=t.getContext||e.hasCanvasOption(r)&&p.getContext,v=t.naturalWidth||t.width,y=t.naturalHeight||t.height,b=v,w=y;function A(){var e=Math.max((o||b)/b,(s||w)/w);e>1&&(b*=e,w*=e)}function x(){var e=Math.min((a||b)/b,(i||w)/w);e<1&&(b*=e,w*=e)}if(m&&(u=(r=e.getTransformedOptions(t,r,n)).left||0,d=r.top||0,r.sourceWidth?(l=r.sourceWidth,void 0!==r.right&&void 0===r.left&&(u=v-l-r.right)):l=v-u-(r.right||0),r.sourceHeight?(c=r.sourceHeight,void 0!==r.bottom&&void 0===r.top&&(d=y-c-r.bottom)):c=y-d-(r.bottom||0),b=l,w=c),a=r.maxWidth,i=r.maxHeight,o=r.minWidth,s=r.minHeight,m&&a&&i&&r.crop?(b=a,w=i,(g=l/c-a/i)<0?(c=i*l/a,void 0===r.top&&void 0===r.bottom&&(d=(y-c)/2)):g>0&&(l=a*c/i,void 0===r.left&&void 0===r.right&&(u=(v-l)/2))):((r.contain||r.cover)&&(o=a=a||o,s=i=i||s),r.cover?(x(),A()):(A(),x())),m){if((h=r.pixelRatio)>1&&(p.style.width=b+"px",p.style.height=w+"px",b*=h,w*=h,p.getContext("2d").scale(h,h)),(f=r.downsamplingRatio)>0&&f<1&&b<l&&w<c)for(;l*f>b;)p.width=l*f,p.height=c*f,e.renderImageToCanvas(p,t,u,d,l,c,0,0,p.width,p.height,r),u=0,d=0,l=p.width,c=p.height,(t=document.createElement("canvas")).width=l,t.height=c,e.renderImageToCanvas(t,p,0,0,l,c,0,0,l,c,r);return p.width=b,p.height=w,e.transformCoordinates(p,r),e.renderImageToCanvas(p,t,u,d,l,c,0,0,b,w,r)}return t.width=b,t.height=w,t}})?n.apply(t,a):n)||(e.exports=i)}()},function(e,t,r){var n,a,i;!function(o){"use strict";a=[r(0),r(1)],void 0===(i="function"==typeof(n=function(e){function t(e){e&&(Object.defineProperty(this,"map",{value:this.privateIFDs[e].map}),Object.defineProperty(this,"tags",{value:this.tags&&this.tags[e]||{}}))}t.prototype.map={Orientation:274,Thumbnail:513,Exif:34665,GPSInfo:34853,Interoperability:40965},t.prototype.privateIFDs={34665:{name:"Exif",map:{}},34853:{name:"GPSInfo",map:{}},40965:{name:"Interoperability",map:{}}},t.prototype.get=function(e){return this[e]||this[this.map[e]]};var r={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,r){return e.getUint16(t,r)},size:2},4:{getValue:function(e,t,r){return e.getUint32(t,r)},size:4},5:{getValue:function(e,t,r){return e.getUint32(t,r)/e.getUint32(t+4,r)},size:8},9:{getValue:function(e,t,r){return e.getInt32(t,r)},size:4},10:{getValue:function(e,t,r){return e.getInt32(t,r)/e.getInt32(t+4,r)},size:8}};function n(e,t,n,a,i,o){var s,l,c,u,d,h,f=r[a];if(f){if(!((l=(s=f.size*i)>4?t+e.getUint32(n+8,o):n+8)+s>e.byteLength)){if(1===i)return f.getValue(e,l,o);for(c=[],u=0;u<i;u+=1)c[u]=f.getValue(e,l+u*f.size,o);if(f.ascii){for(d="",u=0;u<c.length&&"\0"!==(h=c[u]);u+=1)d+=h;return d}return c}console.log("Invalid Exif data: Invalid data offset.")}else console.log("Invalid Exif data: Invalid tag type.")}function a(e,t,r,a,i,o,s,l){var c,u,d,h,f,g;if(r+6>e.byteLength)console.log("Invalid Exif data: Invalid directory offset.");else{if(!((u=r+2+12*(c=e.getUint16(r,a)))+4>e.byteLength)){for(d=0;d<c;d+=1)h=r+2+12*d,f=e.getUint16(h,a),s&&!s[f]||l&&!0===l[f]||(g=n(e,t,h,e.getUint16(h+2,a),e.getUint32(h+4,a),a),i[f]=g,o&&(o[f]=h));return e.getUint32(u,a)}console.log("Invalid Exif data: Invalid directory size.")}}r[7]=r[1],e.parseExifData=function(e,r,n,i,o){if(!o.disableExif){var s,l,c=o.includeExifTags,u=o.excludeExifTags||{34665:{37500:!0}},d=r+10;if(1165519206===e.getUint32(r+4))if(d+8>e.byteLength)console.log("Invalid Exif data: Invalid segment size.");else if(0===e.getUint16(r+8)){switch(e.getUint16(d)){case 18761:s=!0;break;case 19789:s=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}42===e.getUint16(d+2,s)?(l=e.getUint32(d+4,s),i.exif=new t,o.disableExifOffsets||(i.exifOffsets=new t,i.exifTiffOffset=d,i.exifLittleEndian=s),(l=a(e,d,d+l,s,i.exif,i.exifOffsets,c,u))&&!o.disableExifThumbnail&&(l=a(e,d,d+l,s,i.exif,i.exifOffsets,c,u),i.exif[513]&&i.exif[514]&&(i.exif[513]=function(e,t,r){if(r&&!(t+r>e.byteLength))return new Blob([e.buffer.slice(t,t+r)],{type:"image/jpeg"});console.log("Invalid Exif data: Invalid thumbnail data.")}(e,d+i.exif[513],i.exif[514]))),Object.keys(i.exif.privateIFDs).forEach((function(r){!function(e,r,n,i,o,s,l){var c=e.exif[r];c&&(e.exif[r]=new t(r),e.exifOffsets&&(e.exifOffsets[r]=new t(r)),a(n,i,i+c,o,e.exif[r],e.exifOffsets&&e.exifOffsets[r],s&&s[r],l&&l[r]))}(i,r,e,d,s,c,u)}))):console.log("Invalid Exif data: Missing TIFF marker.")}else console.log("Invalid Exif data: Missing byte alignment offset.")}},e.metaDataParsers.jpeg[65505].push(e.parseExifData),e.exifWriters={274:function(e,t,r){return new DataView(e,t.exifOffsets[274]+8,2).setUint16(0,r,t.exifLittleEndian),e}},e.writeExifData=function(t,r,n,a){e.exifWriters[r.exif.map[n]](t,r,a)},e.ExifMap=t})?n.apply(t,a):n)||(e.exports=i)}()},function(e,t,r){var n,a,i;!function(o){"use strict";a=[r(0),r(1)],void 0===(i="function"==typeof(n=function(e){function t(){}function r(e,t,r,n,a){return"binary"===t.types[e]?new Blob([r.buffer.slice(n,n+a)]):"Uint16"===t.types[e]?r.getUint16(n):function(e,t,r){for(var n="",a=t+r,i=t;i<a;i+=1)n+=String.fromCharCode(e.getUint8(i));return n}(r,n,a)}function n(e,t){return void 0===e?t:e instanceof Array?(e.push(t),e):[e,t]}function a(e,t,a,i,o,s){for(var l,c,u,d=t+a,h=t;h<d;)28===e.getUint8(h)&&2===e.getUint8(h+1)&&(u=e.getUint8(h+2),o&&!o[u]||s&&s[u]||(c=e.getInt16(h+3),l=r(u,i.iptc,e,h+5,c),i.iptc[u]=n(i.iptc[u],l),i.iptcOffsets&&(i.iptcOffsets[u]=h))),h+=1}function i(e,t){return 943868237===e.getUint32(t)&&1028===e.getUint16(t+4)}function o(e,t){var r=e.getUint8(t+7);return r%2!=0&&(r+=1),0===r&&(r=4),r}t.prototype.map={ObjectName:5},t.prototype.types={0:"Uint16",200:"Uint16",201:"Uint16",202:"binary"},t.prototype.get=function(e){return this[e]||this[this.map[e]]},e.parseIptcData=function(e,r,n,s,l){if(!l.disableIptc)for(var c=r+n;r+8<c;){if(i(e,r)){var u=o(e,r),d=r+8+u;if(d>c){console.log("Invalid IPTC data: Invalid segment offset.");break}var h=e.getUint16(r+6+u);if(r+h>c){console.log("Invalid IPTC data: Invalid segment size.");break}return s.iptc=new t,l.disableIptcOffsets||(s.iptcOffsets=new t),void a(e,d,h,s,l.includeIptcTags,l.excludeIptcTags||{202:!0})}r+=1}},e.metaDataParsers.jpeg[65517].push(e.parseIptcData),e.IptcMap=t})?n.apply(t,a):n)||(e.exports=i)}()},function(e,t,r){r(13);const{createWorker:n,createScheduler:a,PSM:i}=r(14),o=r(38);var s=document.getElementById("canvas"),l=document.getElementById("canvasBbox"),c=[30,30,200,100],u=!1;var d=document.getElementById("canvas0"),h=d.getContext("2d");["mousedown","mousemove","mouseup"].forEach(e=>{d.addEventListener(e,e=>function(e){e.target.getBoundingClientRect();const t=e.offsetX||e.layerX,r=e.offsetY||e.layerY;return"mousedown"!==e.type||u||(u=!0,c[0]=t,c[2]=t,c[1]=r,c[3]=r),"mousemove"===e.type&&u&&(c[2]=t,c[3]=r),"mouseup"===e.type&&u&&(u=!1,console.log(c)),{x:t,y:r}}(e))});var f=document.getElementById("video"),g=document.querySelector("select#videoSource");function p(){window.stream&&window.stream.getTracks().forEach(e=>{console.log("stop"),e.stop()});const e=g.value;const t={audio:!1,video:{deviceId:e?{exact:e}:void 0,facingMode:"environment",width:{max:600}}};return navigator.mediaDevices.getUserMedia(t).then(A)}g.onchange=p,f.addEventListener("resize",(function(e){d.width=f.videoWidth,d.height=f.videoHeight})),f.addEventListener("play",()=>{requestAnimationFrame((function e(){h.drawImage(f,0,0,d.width,d.height),h.fillStyle="#ffffff77",h.fillRect(c[0],c[1],c[2]-c[0],c[3]-c[1]),requestAnimationFrame(e)}))}),navigator.mediaDevices.enumerateDevices().then((function(e){window.deviceInfos=e,console.log("Available input and output devices:",e);for(const t of e){const e=document.createElement("option");e.value=t.deviceId,"audioinput"===t.kind||"videoinput"===t.kind&&(e.text=t.label||"Camera "+(g.length+1),g.appendChild(e))}}));var m,v={};if(window.location.search&&(m=window.location.href,v=m.match(/([^?=&]+)(=([^&]*))/g).reduce((e,t)=>(e[t.slice(0,t.indexOf("="))]=t.slice(t.indexOf("=")+1),e),{})),v.roi){let e=void 0;try{e=JSON.parse(decodeURI(v.roi)),c=e}catch(e){}}var y=v.font||"digits";"7seg"===y&&(document.getElementById("dilate").value=0),console.log("carregando modelos...");const b=a(),w=n({langPath:"https://ocr.ipt.br",gzip:!1});function A(e){window.stream=e,g.selectedIndex=[...g.options].findIndex(t=>t.text===e.getVideoTracks()[0].label),f.srcObject=e;const t=e.getVideoTracks()[0];console.log(t);const r=new ImageCapture(t),n=()=>new Promise((e,n)=>{-1!==t.label.indexOf(" ")?e(r.takePhoto()):e(r.grabFrame())}).then(e=>new Promise((t,r)=>{if(e instanceof Blob)t(URL.createObjectURL(e));else{const r=document.createElement("canvas");r.width=e.width,r.height=e.height;let n=r.getContext("bitmaprenderer");n?n.transferFromImageBitmap(e):r.getContext("2d").drawImage(e,0,0),r.toBlob(e=>{t(URL.createObjectURL(e))})}})).then(e=>{var t=s.getContext("2d"),r=l.getContext("2d"),n=new Image;let a=[Math.min(c[0],c[2]),Math.min(c[1],c[3]),Math.max(c[0],c[2]),Math.max(c[1],c[3])];n.onload=()=>([r,t].forEach(e=>{e.clearRect(0,0,d.width,d.height),e.drawImage(n,a[0],a[1],a[2]-a[0],a[3]-a[1],0,0,(a[2]-a[0])*(v.hscale?parseFloat(v.hscale):1),(a[3]-a[1])*(v.vscale?parseFloat(v.vscale):1))}),o.default(t,s,n,a),b.addJob("recognize",s).then(e=>{if(!e.data.lines.length)return;let t=e.data.words.filter(e=>e.text.length>1).sort((e,t)=>t.confidence-e.confidence);if(t.length){t[0].symbols.forEach(e=>{r.beginPath(),r.lineWidth="2",r.strokeStyle="green",r.rect(e.bbox.x0,e.bbox.y0,e.bbox.x1-e.bbox.x0,e.bbox.y1-e.bbox.y0),r.stroke()});let e=t[0].symbols.reduce((e,t)=>{const r=(t.bbox.y1-t.bbox.y0)/(t.bbox.x1-t.bbox.x0);return"1"===t.text&&console.log(r),"7seg"===y&&"1"===t.text&&r<2&&r>.8?(e.val+="7",t.confidence*=1.05):e.val+=t.text,void 0===e.confidence?e.confidence=t.confidence:e.confidence=(e.confidence+t.confidence)/2,e},{val:"",confidence:void 0}),n=e.val,a=Math.round(e.confidence||0);if(a>parseFloat(document.getElementById("minconf").value)){let e=(new Date).toISOString().replace("T"," ").replace("Z","");if(document.getElementById("progress").innerText=n,document.getElementById("confidence").innerText=a+" %",document.getElementById("isoString").innerText=e,document.getElementById("confidence").classList=a<70?"has-text-danger":"has-text-success",n.length){let t=n+"\t"+a+"\t"+e.split(".")[0]+"\n";if(v.ws&&(new WebSocket("ws://127.0.0.1:"+v.ws).onopen=e=>{e.target.send(t),e.target.close()}),document.getElementById("ocrlog").checked){let e=document.getElementById("ocrlogtxt");e.value+=t,e.scrollTop=e.scrollHeight}}}}}),URL.revokeObjectURL(e),Promise.resolve(s)),n.src=e}).catch(e=>console.error("takePhoto() error:",e)).finally(()=>{"live"===r.track.readyState&&window.setTimeout(n,parseFloat(document.getElementById("loginterval").value))});n()}console.log("psm:",v.psm),w.load().then(e=>w.loadLanguage(y)).then(e=>w.initialize(y)).then(e=>w.setParameters({tessedit_char_whitelist:v.passlist?v.passlist:"+-0.123456789eE",tessedit_pageseg_mode:v.psm?i[v.psm]:i.SINGLE_BLOCK})).catch(e=>{console.log("Erro ao carregar modelo."),console.log(e)}).finally(e=>(console.log("tesseract ready!"),document.getElementById("loading").style.display="none",b.addWorker(w),p().catch(e=>console.error("getUserMedia() error:",e))))},function(e,t,r){},function(e,t,r){r(15);const n=r(16),a=r(7),i=r(36),o=r(8),s=r(37),{setLogging:l}=r(3);e.exports={OEM:o,PSM:s,createScheduler:n,createWorker:a,setLogging:l,...i}},function(e,t,r){var n=function(e){"use strict";var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var a=t&&t.prototype instanceof d?t:d,i=Object.create(a.prototype),o=new S(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(a,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw i;return F()}for(r.method=a,r.arg=i;;){var o=r.delegate;if(o){var s=w(o,r);if(s){if(s===u)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=c(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}(e,r,o),i}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function d(){}function h(){}function f(){}var g={};g[a]=function(){return this};var p=Object.getPrototypeOf,m=p&&p(p(E([])));m&&m!==t&&r.call(m,a)&&(g=m);var v=f.prototype=d.prototype=Object.create(g);function y(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var n;this._invoke=function(a,i){function o(){return new t((function(n,o){!function n(a,i,o,s){var l=c(e[a],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(d).then((function(e){u.value=e,o(u)}),(function(e){return n("throw",e,o,s)}))}s(l.arg)}(a,i,n,o)}))}return n=n?n.then(o,o):o()}}function w(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function E(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:F}}function F(){return{value:void 0,done:!0}}return h.prototype=v.constructor=f,f.constructor=h,h.displayName=s(f,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s(e,o,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(b.prototype),b.prototype[i]=function(){return this},e.AsyncIterator=b,e.async=function(t,r,n,a,i){void 0===i&&(i=Promise);var o=new b(l(t,r,n,a),i);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},y(v),s(v,o,"Generator"),v[a]=function(){return this},v.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=E,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return o.type="throw",o.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;x(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:E(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t,r){const n=r(6),{log:a}=r(3),i=r(2);let o=0;e.exports=()=>{const e=i("Scheduler",o),t={},r={};let s=[];o+=1;const l=()=>Object.keys(t).length,c=()=>{if(0!==s.length){const e=Object.keys(t);for(let n=0;n<e.length;n+=1)if(void 0===r[e[n]]){s[0](t[e[n]]);break}}},u=(t,i)=>new Promise((o,l)=>{const u=n({action:t,payload:i});s.push(async e=>{s.shift(),r[e.id]=u;try{o(await e[t].apply(this,[...i,u.id]))}catch(e){l(e)}finally{delete r[e.id],c()}}),a(`[${e}]: Add ${u.id} to JobQueue`),a(`[${e}]: JobQueue length=${s.length}`),c()});return{addWorker:r=>(t[r.id]=r,a(`[${e}]: Add ${r.id}`),a(`[${e}]: Number of workers=${l()}`),c(),r.id),addJob:async(t,...r)=>{if(0===l())throw Error(`[${e}]: You need to have at least one worker before adding jobs`);return u(t,r)},terminate:async()=>{Object.keys(t).forEach(async e=>{await t[e].terminate()}),s=[]},getQueueLen:()=>s.length,getNumWorkers:l}}},function(e,t,r){const n="browser"===r(18)("type")?r(5):e=>e;e.exports=e=>{const t={...e};return["corePath","workerPath","langPath"].forEach(r=>{void 0!==e[r]&&(t[r]=n(t[r]))}),t}},function(e,t,r){(function(t){const n=r(19);e.exports=e=>{const r={};return"undefined"!=typeof WorkerGlobalScope?r.type="webworker":"object"==typeof window?r.type="browser":n()?r.type="electron":"object"==typeof t&&(r.type="node"),void 0===e?r:r[e]}}).call(this,r(4))},function(e,t,r){(function(t){e.exports=function(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||(!(void 0===t||"object"!=typeof t.versions||!t.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}}).call(this,r(4))},function(e,t){e.exports=e=>{const t=[],r=[],n=[],a=[],i=[];return e.blocks.forEach(o=>{o.paragraphs.forEach(t=>{t.lines.forEach(r=>{r.words.forEach(n=>{n.symbols.forEach(a=>{i.push({...a,page:e,block:o,paragraph:t,line:r,word:n})}),a.push({...n,page:e,block:o,paragraph:t,line:r})}),n.push({...r,page:e,block:o,paragraph:t})}),r.push({...t,page:e,block:o})}),t.push({...o,page:e})}),{...e,blocks:t,paragraphs:r,lines:n,words:a,symbols:i}}},function(e,t,r){const n=r(8);e.exports={defaultOEM:n.DEFAULT}},function(e,t,r){const n=r(23),a=r(26),i=r(27),o=r(28),s=r(29),l=r(30);e.exports={defaultOptions:n,spawnWorker:a,terminateWorker:i,onMessage:o,send:s,loadImage:l}},function(e,t,r){(function(t){const n=r(5),{version:a,dependencies:i}=r(24),o=r(25);e.exports={...o,workerPath:void 0!==t&&"development"===t.env.TESS_ENV?n("/dist/worker.dev.js?nocache="+Math.random().toString(36).slice(3)):`https://unpkg.com/tesseract.js@v${a}/dist/worker.min.js`,corePath:`https://unpkg.com/tesseract.js-core@v${i["tesseract.js-core"].substring(1)}/tesseract-core.${"object"==typeof WebAssembly?"wasm":"asm"}.js`}}).call(this,r(4))},function(e){e.exports=JSON.parse('{"name":"tesseract.js","version":"2.1.4","description":"Pure Javascript Multilingual OCR","main":"src/index.js","types":"src/index.d.ts","unpkg":"dist/tesseract.min.js","jsdelivr":"dist/tesseract.min.js","scripts":{"start":"node scripts/server.js","build":"rimraf dist && webpack --config scripts/webpack.config.prod.js","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json","prepublishOnly":"npm run build","wait":"rimraf dist && wait-on http://localhost:3000/dist/tesseract.dev.js","test":"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:* test:node:all","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser-tpl":"mocha-headless-chrome -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:detect":"npm run test:browser-tpl -- -f ./tests/detect.test.html","test:browser:recognize":"npm run test:browser-tpl -- -f ./tests/recognize.test.html","test:browser:scheduler":"npm run test:browser-tpl -- -f ./tests/scheduler.test.html","test:browser:FS":"npm run test:browser-tpl -- -f ./tests/FS.test.html","lint":"eslint src","lint:fix":"eslint --fix src","postinstall":"opencollective-postinstall || true"},"browser":{"./src/worker/node/index.js":"./src/worker/browser/index.js"},"author":"","contributors":["jeromewu"],"license":"Apache-2.0","devDependencies":{"@babel/core":"^7.7.7","@babel/preset-env":"^7.7.7","acorn":"^6.4.0","babel-loader":"^8.1.0","cors":"^2.8.5","eslint":"^7.2.0","eslint-config-airbnb-base":"^14.2.0","eslint-plugin-import":"^2.22.1","expect.js":"^0.3.1","express":"^4.17.1","mocha":"^8.1.3","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","nyc":"^15.1.0","rimraf":"^2.7.1","wait-on":"^3.3.0","webpack":"^4.44.2","webpack-bundle-analyzer":"^3.6.0","webpack-cli":"^3.3.12","webpack-dev-middleware":"^3.7.2"},"dependencies":{"blueimp-load-image":"^3.0.0","bmp-js":"^0.1.0","file-type":"^12.4.1","idb-keyval":"^3.2.0","is-electron":"^2.2.0","is-url":"^1.2.4","jpeg-autorotate":"^7.1.1","node-fetch":"^2.6.0","opencollective-postinstall":"^2.0.2","regenerator-runtime":"^0.13.3","resolve-url":"^0.2.1","tesseract.js-core":"^2.2.0","zlibjs":"^0.3.1"},"repository":{"type":"git","url":"https://github.com/naptha/tesseract.js.git"},"bugs":{"url":"https://github.com/naptha/tesseract.js/issues"},"homepage":"https://github.com/naptha/tesseract.js","collective":{"type":"opencollective","url":"https://opencollective.com/tesseractjs"}}')},function(e,t){e.exports={langPath:"https://tessdata.projectnaptha.com/4.0.0",workerBlobURL:!0,logger:()=>{}}},function(e,t){e.exports=({workerPath:e,workerBlobURL:t})=>{let r;if(Blob&&URL&&t){const t=new Blob([`importScripts("${e}");`],{type:"application/javascript"});r=new Worker(URL.createObjectURL(t))}else r=new Worker(e);return r}},function(e,t){e.exports=e=>{e.terminate()}},function(e,t){e.exports=(e,t)=>{e.onmessage=({data:e})=>{t(e)}}},function(e,t){e.exports=async(e,t)=>{e.postMessage(t)}},function(e,t,r){const n=r(5),a=r(31),i=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=()=>{t(n.result)},n.onerror=({target:{error:{code:e}}})=>{r(Error("File could not be read! Code="+e))},n.readAsArrayBuffer(e)}),o=e=>new Promise(t=>{a(e,e=>e.toBlob(t),{orientation:!0,canvas:!0})}),s=async e=>{let t=e;if(void 0===e)return"undefined";if("string"==typeof e)if(e.endsWith(".pbm")){const r=await fetch(n(e));t=await r.arrayBuffer()}else{let r=e;/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e)||(r=n(e)),t=await i(await o(r))}else if(e instanceof HTMLElement)"IMG"===e.tagName&&(t=await s(e.src)),"VIDEO"===e.tagName&&(t=await s(e.poster)),"CANVAS"===e.tagName&&await new Promise(r=>{e.toBlob(async e=>{t=await i(e),r()})});else if(e instanceof File||e instanceof Blob){let r=e;e.name.endsWith(".pbm")||(r=await o(r)),t=await i(r)}return new Uint8Array(t)};e.exports=s},function(e,t,r){e.exports=r(0),r(9),r(1),r(32),r(10),r(33),r(11),r(34),r(35)},function(e,t,r){var n,a,i;!function(o){"use strict";a=[r(0)],void 0===(i="function"==typeof(n=function(e){"undefined"!=typeof fetch&&"undefined"!=typeof Request?e.fetchBlob=function(e,t,r){fetch(new Request(e,r)).then((function(e){return e.blob()})).then(t).catch((function(e){t(null,e)}))}:"undefined"!=typeof XMLHttpRequest&&"undefined"!=typeof ProgressEvent&&(e.fetchBlob=function(e,t,r){r=r||{};var n=new XMLHttpRequest;n.open(r.method||"GET",e),r.headers&&Object.keys(r.headers).forEach((function(e){n.setRequestHeader(e,r.headers[e])})),n.withCredentials="include"===r.credentials,n.responseType="blob",n.onload=function(){t(n.response)},n.onerror=n.onabort=n.ontimeout=function(e){t(null,e)},n.send(r.body)})})?n.apply(t,a):n)||(e.exports=i)}()},function(e,t,r){var n,a,i;!function(o){"use strict";a=[r(0),r(10)],void 0===(i="function"==typeof(n=function(e){var t=e.ExifMap.prototype;t.tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",34665:{36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber"},34853:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},40965:{1:"InteroperabilityIndex"}},t.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},t.getText=function(e){var t=this.get(e);switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[e][t];case"ExifVersion":case"FlashpixVersion":if(!t)return;return String.fromCharCode(t[0],t[1],t[2],t[3]);case"ComponentsConfiguration":if(!t)return;return this.stringValues[e][t[0]]+this.stringValues[e][t[1]]+this.stringValues[e][t[2]]+this.stringValues[e][t[3]];case"GPSVersionID":if(!t)return;return t[0]+"."+t[1]+"."+t[2]+"."+t[3]}return String(t)},t.getAll=function(){var e,t,r,n={};for(e in this)Object.prototype.hasOwnProperty.call(this,e)&&((t=this[e])&&t.getAll?n[this.privateIFDs[e].name]=t.getAll():(r=this.tags[e])&&(n[r]=this.getText(r)));return n},t.getName=function(e){var t=this.tags[e];return"object"==typeof t?this.privateIFDs[e].name:t},function(){var e,r,n,a=t.tags;for(e in a)if(Object.prototype.hasOwnProperty.call(a,e))if(r=t.privateIFDs[e])for(e in n=a[e])Object.prototype.hasOwnProperty.call(n,e)&&(r.map[n[e]]=Number(e));else t.map[a[e]]=Number(e)}()})?n.apply(t,a):n)||(e.exports=i)}()},function(e,t,r){var n,a,i;!function(o){"use strict";a=[r(0),r(11)],void 0===(i="function"==typeof(n=function(e){var t=e.IptcMap.prototype;t.tags={0:"ApplicationRecordVersion",3:"ObjectTypeReference",4:"ObjectAttributeReference",5:"ObjectName",7:"EditStatus",8:"EditorialUpdate",10:"Urgency",12:"SubjectReference",15:"Category",20:"SupplementalCategories",22:"FixtureIdentifier",25:"Keywords",26:"ContentLocationCode",27:"ContentLocationName",30:"ReleaseDate",35:"ReleaseTime",37:"ExpirationDate",38:"ExpirationTime",40:"SpecialInstructions",42:"ActionAdvised",45:"ReferenceService",47:"ReferenceDate",50:"ReferenceNumber",55:"DateCreated",60:"TimeCreated",62:"DigitalCreationDate",63:"DigitalCreationTime",65:"OriginatingProgram",70:"ProgramVersion",75:"ObjectCycle",80:"Byline",85:"BylineTitle",90:"City",92:"Sublocation",95:"State",100:"CountryCode",101:"Country",103:"OriginalTransmissionReference",105:"Headline",110:"Credit",115:"Source",116:"CopyrightNotice",118:"Contact",120:"Caption",121:"LocalCaption",122:"Writer",125:"RasterizedCaption",130:"ImageType",131:"ImageOrientation",135:"LanguageIdentifier",150:"AudioType",151:"AudioSamplingRate",152:"AudioSamplingResolution",153:"AudioDuration",154:"AudioOutcue",184:"JobID",185:"MasterDocumentID",186:"ShortDocumentID",187:"UniqueDocumentID",188:"OwnerID",200:"ObjectPreviewFileFormat",201:"ObjectPreviewFileVersion",202:"ObjectPreviewData",221:"Prefs",225:"ClassifyState",228:"SimilarityIndex",230:"DocumentNotes",231:"DocumentHistory",232:"ExifCameraInfo",255:"CatalogSets"},t.stringValues={10:{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"},75:{a:"Morning",b:"Both Morning and Evening",p:"Evening"},131:{L:"Landscape",P:"Portrait",S:"Square"}},t.getText=function(e){var t=this.get(e),r=this.map[e],n=this.stringValues[r];return n?n[t]:String(t)},t.getAll=function(){var e,t,r={};for(e in this)Object.prototype.hasOwnProperty.call(this,e)&&(t=this.tags[e])&&(r[t]=this.getText(t));return r},t.getName=function(e){return this.tags[e]},function(){var e,r=t.tags,n=t.map||{};for(e in r)Object.prototype.hasOwnProperty.call(r,e)&&(n[r[e]]=Number(e))}()})?n.apply(t,a):n)||(e.exports=i)}()},function(e,t,r){var n,a,i;!function(o){"use strict";a=[r(0),r(9),r(1)],void 0===(i="function"==typeof(n=function(e){var t=e.hasCanvasOption,r=e.hasMetaOption,n=e.transformCoordinates,a=e.getTransformedOptions;i=document.createElement("img"),i.onload=function(){e.orientation=1===i.width&&2===i.height},i.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==",e.hasCanvasOption=function(r){return!0==!!r.orientation&&!e.orientation||r.orientation>1&&r.orientation<9||t.call(e,r)},e.hasMetaOption=function(t){return t&&!0===t.orientation&&!e.orientation||r.call(e,t)},e.transformCoordinates=function(t,r){n.call(e,t,r);var a=t.getContext("2d"),i=t.width,o=t.height,s=t.style.width,l=t.style.height,c=r.orientation;if(c>1&&c<9)switch(c>4&&(t.width=o,t.height=i,t.style.width=l,t.style.height=s),c){case 2:a.translate(i,0),a.scale(-1,1);break;case 3:a.translate(i,o),a.rotate(Math.PI);break;case 4:a.translate(0,o),a.scale(1,-1);break;case 5:a.rotate(.5*Math.PI),a.scale(1,-1);break;case 6:a.rotate(.5*Math.PI),a.translate(0,-o);break;case 7:a.rotate(.5*Math.PI),a.translate(i,-o),a.scale(-1,1);break;case 8:a.rotate(-.5*Math.PI),a.translate(-i,0)}},e.getTransformedOptions=function(t,r,n){var i,o,s=a.call(e,t,r),l=s.orientation;if(!0===l){if(e.orientation)return s;l=n&&n.exif&&n.exif.get("Orientation")}if(!(l>1&&l<9))return s;for(o in i={},s)Object.prototype.hasOwnProperty.call(s,o)&&(i[o]=s[o]);switch(i.orientation=l,l){case 2:i.left=s.right,i.right=s.left;break;case 3:i.left=s.right,i.top=s.bottom,i.right=s.left,i.bottom=s.top;break;case 4:i.top=s.bottom,i.bottom=s.top;break;case 5:i.left=s.top,i.top=s.left,i.right=s.bottom,i.bottom=s.right;break;case 6:i.left=s.top,i.top=s.right,i.right=s.bottom,i.bottom=s.left;break;case 7:i.left=s.bottom,i.top=s.right,i.right=s.top,i.bottom=s.left;break;case 8:i.left=s.bottom,i.top=s.left,i.right=s.top,i.bottom=s.right}return i.orientation>4&&(i.maxWidth=s.maxHeight,i.maxHeight=s.maxWidth,i.minWidth=s.minHeight,i.minHeight=s.minWidth,i.sourceWidth=s.sourceHeight,i.sourceHeight=s.sourceWidth),i};var i})?n.apply(t,a):n)||(e.exports=i)}()},function(e,t,r){const n=r(7);e.exports={recognize:async(e,t,r)=>{const a=n(r);return await a.load(),await a.loadLanguage(t),await a.initialize(t),a.recognize(e).finally(async()=>{await a.terminate()})},detect:async(e,t)=>{const r=n(t);return await r.load(),await r.loadLanguage("osd"),await r.initialize("osd"),r.detect(e).finally(async()=>{await r.terminate()})}}},function(e,t){e.exports={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12"}},function(e,t,r){"use strict";r.r(t);const{Filters:n}=r(39);t.default=function(e,t,r,a){var i=r.width,o=r.height;!function(e,t,r){for(var n=e.getImageData(0,0,t,r),a=n.data,i=0;i<a.length;i+=4){var o=.2126*a[i]+.7152*a[i+1]+.0722*a[i+2];a[i]=o,a[i+1]=o,a[i+2]=o}e.putImageData(n,0,0)}(e,i,o);var s=1/(parseFloat(document.getElementById("gamma").value)/10),l=e.getImageData(0,0,t.width,t.height);function c(e,r){var n=4*parseInt(e+t.width*r);return{r:l.data[n+0],g:l.data[n+1],b:l.data[n+2]}}for(let e=0;e<t.height;e++)for(let r=0;r<t.width;r++){var u=c(r,e),d=(u={r:255*Math.pow(u.r/255,s),g:255*Math.pow(u.g/255,s),b:255*Math.pow(u.b/255,s)},4*parseInt(r+t.width*e)),h=l.data;h[d+0]=u.r,h[d+1]=u.g,h[d+2]=u.b}e.putImageData(l,0,0),function(e,t,r,n){for(var a,i=t.getImageData(0,0,r,n),o=i.data,s=0;s<o.length;s+=4){var l=.2126*o[s]+.7152*o[s+1]+.0722*o[s+2];a=document.getElementById("inverter").checked?l>e?0:255:l>e?255:0,o[s]=a,o[s+1]=a,o[s+2]=a}t.putImageData(i,0,0)}(function(e,t){for(var r=0,n=1;n<256;++n)r+=n*e[n];var a,i,o=0,s=0,l=0,c=0,u=0,d=0,h=0;for(n=0;n<256;++n)if(0!=(s+=e[n])){if(0==(l=t-s))break;a=(o+=n*e[n])/s,i=(r-o)/l,(u=s*l*Math.pow(a-i,2))>=c&&(d=n,u>c&&(h=n),c=u)}return(d+h)/2}(function(e,t,r){for(var n,a=e.getImageData(0,0,t,r).data,i=Array.apply(null,new Array(256)).map(Number.prototype.valueOf,0),o=0;o<a.length;o+=4)n=.2126*a[o]+.7152*a[o+1]+.0722*a[o+2],i[Math.floor(n)]+=1;return i}(e,i,o),i*o),e,i,o);let f=~~document.getElementById("dilate").value;f&&(l=e.getImageData(0,0,t.width,t.height),l=n.invert(l),1===f&&(l=n.convolve(l,[1,1,1,1,1,1,1,1,1]),l=n.invert(l),e.putImageData(l,0,0,0,0,a[2]-a[0]-1,a[3]-a[1]-1)),2===f&&(l=n.convolve(l,[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]),l=n.invert(l),e.putImageData(l,0,0,0,0,a[2]-a[0]-1,a[3]-a[1]-1)))}},function(e,t,r){Filters={},"undefined"==typeof Float32Array?Filters.getFloat32Array=Filters.getUint8Array=function(e){return e.length?e.slice(0):new Array(e)}:(Filters.getFloat32Array=function(e){return new Float32Array(e)},Filters.getUint8Array=function(e){return new Uint8Array(e)}),"undefined"!=typeof document?(Filters.tmpCanvas=document.createElement("canvas"),Filters.tmpCtx=Filters.tmpCanvas.getContext("2d"),Filters.getPixels=function(e){var t,r;if(e.getContext){t=e;try{r=t.getContext("2d")}catch(e){}}return r||(r=(t=this.getCanvas(e.width,e.height)).getContext("2d")).drawImage(e,0,0),r.getImageData(0,0,t.width,t.height)},Filters.createImageData=function(e,t){return this.tmpCtx.createImageData(e,t)},Filters.getCanvas=function(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r},Filters.filterImage=function(e,t,r){for(var n=[this.getPixels(t)],a=2;a<arguments.length;a++)n.push(arguments[a]);return e.apply(this,n)},Filters.toCanvas=function(e){var t=this.getCanvas(e.width,e.height);return t.getContext("2d").putImageData(e,0,0),t},Filters.toImageData=function(e){return this.identity(e)}):(onmessage=function(e){var t=e.data;t.length||(t=[t]),postMessage(Filters.runPipeline(t))},Filters.createImageData=function(e,t){return{width:e,height:t,data:this.getFloat32Array(e*t*4)}}),Filters.runPipeline=function(e){var t=null;t=this[e[0].name].apply(this,e[0].args);for(var r=1;r<e.length;r++){var n=e[r],a=n.args.slice(0);a.unshift(t),t=this[n.name].apply(this,a)}return t},Filters.createImageDataFloat32=function(e,t){return{width:e,height:t,data:this.getFloat32Array(e*t*4)}},Filters.identity=function(e,t){for(var r=Filters.createImageData(e.width,e.height),n=r.data,a=e.data,i=0;i<a.length;i++)n[i]=a[i];return r},Filters.horizontalFlip=function(e){for(var t=Filters.createImageData(e.width,e.height),r=e.width,n=e.height,a=t.data,i=e.data,o=0;o<n;o++)for(var s=0;s<r;s++){var l=4*(o*r+s),c=4*(o*r+(r-s-1));a[c]=i[l],a[c+1]=i[l+1],a[c+2]=i[l+2],a[c+3]=i[l+3]}return t},Filters.verticalFlip=function(e){for(var t=Filters.createImageData(e.width,e.height),r=e.width,n=e.height,a=t.data,i=e.data,o=0;o<n;o++)for(var s=0;s<r;s++){var l=4*(o*r+s),c=4*((n-o-1)*r+s);a[c]=i[l],a[c+1]=i[l+1],a[c+2]=i[l+2],a[c+3]=i[l+3]}return t},Filters.luminance=function(e,t){for(var r=Filters.createImageData(e.width,e.height),n=r.data,a=e.data,i=0;i<a.length;i+=4){var o=.2126*a[i]+.7152*a[i+1]+.0722*a[i+2];n[i]=n[i+1]=n[i+2]=o,n[i+3]=a[i+3]}return r},Filters.grayscale=function(e,t){for(var r=Filters.createImageData(e.width,e.height),n=r.data,a=e.data,i=0;i<a.length;i+=4){var o=.3*a[i]+.59*a[i+1]+.11*a[i+2];n[i]=n[i+1]=n[i+2]=o,n[i+3]=a[i+3]}return r},Filters.grayscaleAvg=function(e,t){for(var r=Filters.createImageData(e.width,e.height),n=r.data,a=e.data,i=0;i<a.length;i+=4){var o=(a[i]+a[i+1]+a[i+2])*(1/3);n[i]=n[i+1]=n[i+2]=o,n[i+3]=a[i+3]}return r},Filters.threshold=function(e,t,r,n){var a=Filters.createImageData(e.width,e.height);null==r&&(r=255),null==n&&(n=0);for(var i=e.data,o=a.data,s=0;s<i.length;s+=4){var l=.3*i[s]+.59*i[s+1]+.11*i[s+2]>=t?r:n;o[s]=o[s+1]=o[s+2]=l,o[s+3]=i[s+3]}return a},Filters.invert=function(e){for(var t=Filters.createImageData(e.width,e.height),r=e.data,n=t.data,a=0;a<r.length;a+=4)n[a]=255-r[a],n[a+1]=255-r[a+1],n[a+2]=255-r[a+2],n[a+3]=r[a+3];return t},Filters.brightnessContrast=function(e,t,r){var n=this.brightnessContrastLUT(t,r);return this.applyLUT(e,{r:n,g:n,b:n,a:this.identityLUT()})},Filters.applyLUT=function(e,t){for(var r=Filters.createImageData(e.width,e.height),n=e.data,a=r.data,i=t.r,o=t.g,s=t.b,l=t.a,c=0;c<n.length;c+=4)a[c]=i[n[c]],a[c+1]=o[n[c+1]],a[c+2]=s[n[c+2]],a[c+3]=l[n[c+3]];return r},Filters.createLUTFromCurve=function(e){for(var t=this.getUint8Array(256),r=[0,0],n=0,a=0;n<t.length;n++){for(;a<e.length&&e[a][0]<n;)r=e[a],a++;t[n]=r[1]}return t},Filters.identityLUT=function(){for(var e=this.getUint8Array(256),t=0;t<e.length;t++)e[t]=t;return e},Filters.invertLUT=function(){for(var e=this.getUint8Array(256),t=0;t<e.length;t++)e[t]=255-t;return e},Filters.brightnessContrastLUT=function(e,t){for(var r=this.getUint8Array(256),n=-128*t+128+255*e,a=0;a<r.length;a++){var i=a*t+n;r[a]=i<0?0:i>255?255:i}return r},Filters.convolve=function(e,t,r){for(var n=Math.round(Math.sqrt(t.length)),a=Math.floor(n/2),i=e.data,o=e.width,s=e.height,l=o,c=s,u=Filters.createImageData(l,c),d=u.data,h=r?1:0,f=0;f<c;f++)for(var g=0;g<l;g++){for(var p=f,m=g,v=4*(f*l+g),y=0,b=0,w=0,A=0,x=0;x<n;x++)for(var S=0;S<n;S++){var E=4*(Math.min(s-1,Math.max(0,p+x-a))*o+Math.min(o-1,Math.max(0,m+S-a))),F=t[x*n+S];y+=i[E]*F,b+=i[E+1]*F,w+=i[E+2]*F,A+=i[E+3]*F}d[v]=y,d[v+1]=b,d[v+2]=w,d[v+3]=A+h*(255-A)}return u},Filters.verticalConvolve=function(e,t,r){for(var n=t.length,a=Math.floor(n/2),i=e.data,o=e.width,s=e.height,l=o,c=s,u=Filters.createImageData(l,c),d=u.data,h=r?1:0,f=0;f<c;f++)for(var g=0;g<l;g++){for(var p=f,m=g,v=4*(f*l+g),y=0,b=0,w=0,A=0,x=0;x<n;x++){var S=4*(Math.min(s-1,Math.max(0,p+x-a))*o+m),E=t[x];y+=i[S]*E,b+=i[S+1]*E,w+=i[S+2]*E,A+=i[S+3]*E}d[v]=y,d[v+1]=b,d[v+2]=w,d[v+3]=A+h*(255-A)}return u},Filters.horizontalConvolve=function(e,t,r){for(var n=t.length,a=Math.floor(n/2),i=e.data,o=e.width,s=o,l=e.height,c=Filters.createImageData(s,l),u=c.data,d=r?1:0,h=0;h<l;h++)for(var f=0;f<s;f++){for(var g=h,p=f,m=4*(h*s+f),v=0,y=0,b=0,w=0,A=0;A<n;A++){var x=4*(g*o+Math.min(o-1,Math.max(0,p+A-a))),S=t[A];v+=i[x]*S,y+=i[x+1]*S,b+=i[x+2]*S,w+=i[x+3]*S}u[m]=v,u[m+1]=y,u[m+2]=b,u[m+3]=w+d*(255-w)}return c},Filters.separableConvolve=function(e,t,r,n){return this.horizontalConvolve(this.verticalConvolveFloat32(e,r,n),t,n)},Filters.convolveFloat32=function(e,t,r){for(var n=Math.round(Math.sqrt(t.length)),a=Math.floor(n/2),i=e.data,o=e.width,s=e.height,l=o,c=s,u=Filters.createImageDataFloat32(l,c),d=u.data,h=r?1:0,f=0;f<c;f++)for(var g=0;g<l;g++){for(var p=f,m=g,v=4*(f*l+g),y=0,b=0,w=0,A=0,x=0;x<n;x++)for(var S=0;S<n;S++){var E=4*(Math.min(s-1,Math.max(0,p+x-a))*o+Math.min(o-1,Math.max(0,m+S-a))),F=t[x*n+S];y+=i[E]*F,b+=i[E+1]*F,w+=i[E+2]*F,A+=i[E+3]*F}d[v]=y,d[v+1]=b,d[v+2]=w,d[v+3]=A+h*(255-A)}return u},Filters.verticalConvolveFloat32=function(e,t,r){for(var n=t.length,a=Math.floor(n/2),i=e.data,o=e.width,s=e.height,l=o,c=s,u=Filters.createImageDataFloat32(l,c),d=u.data,h=r?1:0,f=0;f<c;f++)for(var g=0;g<l;g++){for(var p=f,m=g,v=4*(f*l+g),y=0,b=0,w=0,A=0,x=0;x<n;x++){var S=4*(Math.min(s-1,Math.max(0,p+x-a))*o+m),E=t[x];y+=i[S]*E,b+=i[S+1]*E,w+=i[S+2]*E,A+=i[S+3]*E}d[v]=y,d[v+1]=b,d[v+2]=w,d[v+3]=A+h*(255-A)}return u},Filters.horizontalConvolveFloat32=function(e,t,r){for(var n=t.length,a=Math.floor(n/2),i=e.data,o=e.width,s=o,l=e.height,c=Filters.createImageDataFloat32(s,l),u=c.data,d=r?1:0,h=0;h<l;h++)for(var f=0;f<s;f++){for(var g=h,p=f,m=4*(h*s+f),v=0,y=0,b=0,w=0,A=0;A<n;A++){var x=4*(g*o+Math.min(o-1,Math.max(0,p+A-a))),S=t[A];v+=i[x]*S,y+=i[x+1]*S,b+=i[x+2]*S,w+=i[x+3]*S}u[m]=v,u[m+1]=y,u[m+2]=b,u[m+3]=w+d*(255-w)}return c},Filters.separableConvolveFloat32=function(e,t,r,n){return this.horizontalConvolveFloat32(this.verticalConvolveFloat32(e,r,n),t,n)},Filters.gaussianBlur=function(e,t){if((t=Math.abs(t))<=1)return Filters.identity(e);for(var r=t/2,n=Math.ceil(t)+(1-Math.ceil(t)%2),a=this.getFloat32Array(n),i=(r+.5)/3,o=i*i,s=1/Math.sqrt(2*Math.PI*o),l=-1/(2*i*i),c=0,u=Math.floor(n/2),d=0;d<n;d++){var h=d-u,f=s*Math.exp(h*h*l);a[d]=f,c+=f}for(d=0;d<a.length;d++)a[d]/=c;return Filters.separableConvolve(e,a,a,!1)},Filters.laplaceKernel=Filters.getFloat32Array([-1,-1,-1,-1,8,-1,-1,-1,-1]),Filters.laplace=function(e){return Filters.convolve(e,this.laplaceKernel,!0)},Filters.sobelSignVector=Filters.getFloat32Array([-1,0,1]),Filters.sobelScaleVector=Filters.getFloat32Array([1,2,1]),Filters.sobelVerticalGradient=function(e){return this.separableConvolveFloat32(e,this.sobelSignVector,this.sobelScaleVector)},Filters.sobelHorizontalGradient=function(e){return this.separableConvolveFloat32(e,this.sobelScaleVector,this.sobelSignVector)},Filters.sobelVectors=function(e){for(var t=this.sobelVerticalGradient(e),r=this.sobelHorizontalGradient(e),n={width:t.width,height:t.height,data:this.getFloat32Array(t.width*t.height*8)},a=t.data,i=r.data,o=n.data,s=0,l=0;s<o.length;s+=2,l++)o[s]=i[l],o[s+1]=a[l];return n},Filters.sobel=function(e){e=this.grayscale(e);for(var t=this.sobelVerticalGradient(e),r=this.sobelHorizontalGradient(e),n=this.createImageData(t.width,t.height),a=0;a<n.data.length;a+=4){var i=Math.abs(t.data[a]);n.data[a]=i;var o=Math.abs(r.data[a]);n.data[a+1]=o,n.data[a+2]=(i+o)/4,n.data[a+3]=255}return n},Filters.bilinearSample=function(e,t,r,n){var a=Math.floor(t),i=Math.ceil(t),o=Math.floor(r),s=Math.ceil(r),l=4*(a+e.width*o),c=4*(i+e.width*o),u=4*(a+e.width*s),d=4*(i+e.width*s),h=t-a+(r-o),f=i-t+(r-o),g=t-a+(s-r),p=i-t+(s-r),m=1/(p+g+f+h);p*=m,g*=m,f*=m,h*=m;var v=e.data;return n[0]=v[l]*p+v[c]*g+v[u]*f+v[d]*h,n[1]=v[l+1]*p+v[c+1]*g+v[u+1]*f+v[d+1]*h,n[2]=v[l+2]*p+v[c+2]*g+v[u+2]*f+v[d+2]*h,n[3]=v[l+3]*p+v[c+3]*g+v[u+3]*f+v[d+3]*h,n},Filters.distortSine=function(e,t,r){null==t&&(t=.5),null==r&&(r=t);for(var n=this.createImageData(e.width,e.height),a=n.data,i=(e.data,this.createImageData(1,1).data),o=0;o<n.height;o++){var s=o+-Math.sin(o/(n.height-1)*Math.PI*2)*r*n.height/4;s=Math.max(Math.min(s,n.height-1),0);for(var l=0;l<n.width;l++){var c=l+-Math.sin(l/(n.width-1)*Math.PI*2)*t*n.width/4;c=Math.max(Math.min(c,n.width-1),0);var u=this.bilinearSample(e,c,s,i),d=4*(o*n.width+l);a[d]=u[0],a[d+1]=u[1],a[d+2]=u[2],a[d+3]=u[3]}}return n},Filters.darkenBlend=function(e,t){for(var r=Filters.createImageData(e.width,e.height),n=e.data,a=t.data,i=r.data,o=0;o<n.length;o+=4)i[o]=n[o]<a[o]?n[o]:a[o],i[o+1]=n[o+1]<a[o+1]?n[o+1]:a[o+1],i[o+2]=n[o+2]<a[o+2]?n[o+2]:a[o+2],i[o+3]=n[o+3]+(255-n[o+3])*a[o+3]*(1/255);return r},Filters.lightenBlend=function(e,t){for(var r=Filters.createImageData(e.width,e.height),n=e.data,a=t.data,i=r.data,o=0;o<n.length;o+=4)i[o]=n[o]>a[o]?n[o]:a[o],i[o+1]=n[o+1]>a[o+1]?n[o+1]:a[o+1],i[o+2]=n[o+2]>a[o+2]?n[o+2]:a[o+2],i[o+3]=n[o+3]+(255-n[o+3])*a[o+3]*(1/255);return r},Filters.multiplyBlend=function(e,t){for(var r=Filters.createImageData(e.width,e.height),n=e.data,a=t.data,i=r.data,o=1/255,s=0;s<n.length;s+=4)i[s]=n[s]*a[s]*o,i[s+1]=n[s+1]*a[s+1]*o,i[s+2]=n[s+2]*a[s+2]*o,i[s+3]=n[s+3]+(255-n[s+3])*a[s+3]*o;return r},Filters.screenBlend=function(e,t){for(var r=Filters.createImageData(e.width,e.height),n=e.data,a=t.data,i=r.data,o=1/255,s=0;s<n.length;s+=4)i[s]=n[s]+a[s]-n[s]*a[s]*o,i[s+1]=n[s+1]+a[s+1]-n[s+1]*a[s+1]*o,i[s+2]=n[s+2]+a[s+2]-n[s+2]*a[s+2]*o,i[s+3]=n[s+3]+(255-n[s+3])*a[s+3]*o;return r},Filters.addBlend=function(e,t){for(var r=Filters.createImageData(e.width,e.height),n=e.data,a=t.data,i=r.data,o=0;o<n.length;o+=4)i[o]=n[o]+a[o],i[o+1]=n[o+1]+a[o+1],i[o+2]=n[o+2]+a[o+2],i[o+3]=n[o+3]+(255-n[o+3])*a[o+3]*(1/255);return r},Filters.subBlend=function(e,t){for(var r=Filters.createImageData(e.width,e.height),n=e.data,a=t.data,i=r.data,o=0;o<n.length;o+=4)i[o]=n[o]+a[o]-255,i[o+1]=n[o+1]+a[o+1]-255,i[o+2]=n[o+2]+a[o+2]-255,i[o+3]=n[o+3]+(255-n[o+3])*a[o+3]*(1/255);return r},Filters.differenceBlend=function(e,t){for(var r=Filters.createImageData(e.width,e.height),n=e.data,a=t.data,i=r.data,o=0;o<n.length;o+=4)i[o]=Math.abs(n[o]-a[o]),i[o+1]=Math.abs(n[o+1]-a[o+1]),i[o+2]=Math.abs(n[o+2]-a[o+2]),i[o+3]=n[o+3]+(255-n[o+3])*a[o+3]*(1/255);return r},Filters.erode=function(e){for(var t=e.data,r=e.width,n=r,a=e.height,i=Filters.createImageData(n,a),o=i.data,s=0;s<a;s++)for(var l=0;l<n;l++){var c=s,u=l,d=4*(s*n+l),h=0;0==t[4*(c*r+u)]?0==t[4*(c*r+Math.max(0,u-1))]&&0==t[4*(Math.max(0,c-1)*r+u)]&&(h=255):h=255,o[d]=h,o[d+1]=h,o[d+2]=h,o[d+3]=255}return i},t.Filters=Filters}]);